query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP]
([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],
[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS])
VALUES(",lista ,")")
View(query)
lista[j] <-paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")")
View(lista)
lista[j] <-data.frame(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
for (j in 1:length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)) {
lista[j] <-data.frame(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
}
apply(lista, 1, paste0)
apply(lista, 1, paste0,collapse="','")
dummy <- data.frame(date = as.Date(c("2017-06-10", "2017-06-11","2017-06-10", "2017-06-11")),
campaign = c("Campaign A", "Campaign A", "Campaign B", "Campaign B"),
value = 1:4)
paste0(lista,",")
valores<-paste0(lista,",")
valores
for (j in 1:length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)) {
lista[j] <-data.frame(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
}
valores<-paste0(lista,",")
valores
for (j in 1:length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)) {
lista[j] <-(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
}
valores<-paste0(lista,",")
valores
valores<-paste0(lista,"")
valores
valores<-paste0(lista,",")
valores
apply(lista, 1, paste0,collapse="','")
paste0(lista,collapse = ",")
lista<-paste0(lista,collapse = ",")
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP]
([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],
[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS])
VALUES(",lista ,")")
query
dbExecute(con,query)
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP]
([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],
[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS])
VALUES(",lista ,")")
dbExecute(con,query)
query
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES(",lista ,")")
dbExecute(con,query)
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES(",lista ,")")
query
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
dbExecute(con,query)
query
dbExecute(con,query)
for (j in 1:1000) {
lista[j] <-(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
}
paste0(lista,collapse = ",")
lista<-paste0(lista,collapse = ",")
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
dbExecute(con,query)
floor(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS/1000)
floor(LENGTH(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)/1000)
floor(length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)/1000)
ceiling(length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)/1000)
Num_listas<-ceiling(length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)/1000)
for (i in 1:Num_listas) {
for (j in 1:1000) {
lista[i,j] <-(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
lista[i] <-paste0(lista,collapse = ",")
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
}  }
lista1[i] <-paste0(lista,collapse = ",")
lista1<-1
for (i in 1:Num_listas) {
for (j in 1:1000) {
lista[i,j] <-(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
lista1[i] <-paste0(lista,collapse = ",")
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
}  }
lista[1,1] <-1
lista[1,1] <-c(1,1)
lista[1,1] <-0
lista[1,1] <-data.frame(0)
lista[1,1] <-data.frame(0)
lista <-data.frame(nrow(10),ncol(10))
lista <-data.frame(0,nrow(10),ncol(10))
lista <-data.frame(1:100,nrow(10),ncol(10))
lista <-data.frame(1:10,nrow(10),ncol(10))
lista <-data.frame(nrow(10),ncol(10))
for (i in 1:Num_listas) {
for (j in 1:1000) {
lista[i,j] <-(paste0("(",j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")") )
lista1[i] <-paste0(lista,collapse = ",")
query<-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
}  }
1200%1000
mod(1200,1000)
1200 mod 1000
mod(10,2)
1200%%1000
12000%%1000
for (i in 1:Num_listas) {
for (j in 1:1000) {
a<-j+((i-1)*1000)
lista[j] <-(paste0("(",a,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[a],",",TOTAL_PERSONAS$COD_ROL[a],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[a],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[a],")") )
if (a%%1000==0) {
lista1[i] <-paste0(lista,collapse = ",")
query[i] <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
}
}  }
for (i in 1:Num_listas) {
for (j in 1:1000) {
a<-j+((i-1)*1000)
lista[j] <-(paste0("(",a,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[a],",",TOTAL_PERSONAS$COD_ROL[a],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[a],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[a],")") )
if (a%%1000==0) {
lista1[i] <-paste0(lista,collapse = ",")
query[i] <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista1 ,";")
}
}  }
1%%1000
2000%%1000
for (i in 1:Num_listas) {
for (j in 1:1000) {
a<-j+((i-1)*1000)
lista[j] <-(paste0("(",a,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[a],",",TOTAL_PERSONAS$COD_ROL[a],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[a],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[a],")") )
if (a%%1000==0) {
lista1 <-paste0(lista,collapse = ",")
query <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista1 ,";")
}
}
}
length(query)
query
lista1
lista[1]
lista[2]
lista[6]
lista[1000]
lista[1001]
for (i in 1:Num_listas) {
for (j in 1:1000) {
a<-j+((i-1)*1000)
lista[i] <-(paste0("(",a,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[a],",",TOTAL_PERSONAS$COD_ROL[a],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[a],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[a],")") )
if (a%%1000==0) {
lista1 <-paste0(lista,collapse = ",")
query <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista1 ,";")
}
}
}
lista[1]
lista[1000]
lista[1001]
for (i in 1:Num_listas) {
for (j in 1:1000) {
a<-j+((i-1)*1000)
lista <-(paste0("(",a,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[a],",",TOTAL_PERSONAS$COD_ROL[a],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[a],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[a],")") )
if (a%%1000==0) {
lista1 <-paste0(lista,collapse = ",")
query <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista1 ,";")
}
}
}
lista[1001]
query
for (i in 1:length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)) {
lista <-(paste0("(",i,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[i],",",TOTAL_PERSONAS$COD_ROL[i],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[i],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[i],")") )
}
lista <-paste0(lista,collapse = ",")
query <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista1 ,";")
query
for (i in 1:length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)) {
lista[i] <-(paste0("(",i,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[i],",",TOTAL_PERSONAS$COD_ROL[i],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[i],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[i],")") )
}
lista <-paste0(lista,collapse = ",")
query <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista1 ,";")
query
for (i in 1:length(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS)) {
lista[i] <-(paste0("(",i,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[i],",",TOTAL_PERSONAS$COD_ROL[i],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[i],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[i],")") )
}
lista <-paste0(lista,collapse = ",")
query <-paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES",lista ,";")
query
query
nrow(TOTAL_PERSONAS)
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(TOTAL_PERSONAS[k,],collapse = ','), ')')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
#INSERT PARTIENDO EN PARTES LOS INSERT---------------------
chunksize = 10000 # arbitrary chunk size
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(TOTAL_PERSONAS[k,],collapse = ','), ')')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
TOTAL_PERSONAS[1:10,]
paste0(TOTAL_PERSONAS[1:10,],collapse = ",")
paste0(TOTAL_PERSONAS[1:10,],collapse = ", ")
paste0(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[1:10,],collapse = ", ")
paste0(TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[1:10],collapse = ", ")
paste0(TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[1:10],collapse = ", ")
#INSERT PARTIENDO EN PARTES LOS INSERT---------------------
chunksize = 10000 # arbitrary chunk size
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0("(",i,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[i],",",TOTAL_PERSONAS$COD_ROL[i],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[i],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[i],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
query
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(i,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[i],",",TOTAL_PERSONAS$COD_ROL[i],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[i],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[i],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
query
#INSERT PARTIENDO EN PARTES LOS INSERT---------------------
chunksize = 1000 # arbitrary chunk size
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
vals
vals[1]
vals[2]
vals[5]
vals[100]
vals[1000]
vals[10001]
vals[1001]
vals[99]
vals[980]
vals[900]
vals[800]
vals[850]
vals[820]
vals[810]
vals[815]
vals[813]
vals[814]
#INSERT PARTIENDO EN PARTES LOS INSERT---------------------
chunksize = 100 # arbitrary chunk size
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
#INSERT PARTIENDO EN PARTES LOS INSERT---------------------
chunksize = 1000 # arbitrary chunk size
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(j,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[j],",",TOTAL_PERSONAS$COD_ROL[j],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[j],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[j],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(k,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[k],",",TOTAL_PERSONAS$COD_ROL[k],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[k],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
}
query
query
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(k,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[k],",",TOTAL_PERSONAS$COD_ROL[k],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[k],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(k,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[k],",",TOTAL_PERSONAS$COD_ROL[k],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[k],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
TABLA_TEMPORAL<-TOTAL_PERSONAS[COD_FORMAS_PAGO_FECHAS==216]
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==216]
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==216,]
View(TABLA_TEMPORAL)
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==216 & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==228,]
View(TABLA_TEMPORAL)
#CÓDIGO PARA INSERTAR MUCHAS LÍNEAS DE DATOS EN LA BASE DE DATOS (EFICIENCIA MEDIA)-----------
before=Sys.time()
chunksize = 1000 # arbitrary chunk size
for (i in 1:ceiling(nrow(TOTAL_PERSONAS)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TOTAL_PERSONAS)) {
vals[j] = paste0('(', paste0(k,",",TOTAL_PERSONAS$COD_CONTRATO_PROYECTO[k],",",TOTAL_PERSONAS$COD_ROL[k],",",TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS[k],",",TOTAL_PERSONAS$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
time=Sys.time()-before
time
#FUNCIÓN DE VALOR A FACTURAR TOMANDO FECHA Y PROYECTO -----------------
factura<-function(fecha, proyecto){
chunksize = 1000 # arbitrary chunk size
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==fecha & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==proyecto,]
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(', paste0(k,",",TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
}
factura(214,228)
factura(214,228)
factura(215,228)
factura(216,229)
factura(216,228)
factura(216,228)
#FUNCIÓN DE VALOR A FACTURAR TOMANDO FECHA Y PROYECTO -----------------
factura<-function(fecha, proyecto){
eliminar<-paste0("DELETE FROM [dbo].[DETALLE_FACTURA_PERS_TEMP] WHERE [COD_CONTRATO_PROYECTO] =", proyecto, "AND COD_FORMAS_PAGO_FECHAS=",fecha)
dbExecute(con, eliminar)
chunksize = 1000 # arbitrary chunk size
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==fecha & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==proyecto,]
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS],[COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(', paste0(k,",",TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
}
factura(216,228)
#FUNCIÓN DE VALOR A FACTURAR TOMANDO FECHA Y PROYECTO -----------------
factura<-function(fecha, proyecto){
eliminar<-paste0("DELETE FROM [dbo].[DETALLE_FACTURA_PERS] WHERE [COD_CONTRATO_PROYECTO] =", proyecto, "AND COD_FORMAS_PAGO_FECHAS=",fecha)
dbExecute(con, eliminar)
chunksize = 1000 # arbitrary chunk size
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==fecha & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==proyecto,]
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(', paste0(TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
}
factura(216,228)
query = paste0(query, paste0(vals,collapse=','))
query
#FUNCIÓN DE VALOR A FACTURAR TOMANDO FECHA Y PROYECTO -----------------
factura<-function(fecha, proyecto){
eliminar<-paste0("DELETE FROM [dbo].[DETALLE_FACTURA_PERS] WHERE [COD_CONTRATO_PROYECTO] =", proyecto, "AND COD_FORMAS_PAGO_FECHAS=",fecha)
dbExecute(con, eliminar)
chunksize = 1000 # arbitrary chunk size
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==fecha & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==proyecto,]
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(', paste0(TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
}
query
factura(216,228)
#FUNCIÓN DE VALOR A FACTURAR TOMANDO FECHA Y PROYECTO -----------------
factura<-function(fecha, proyecto){
eliminar<-paste0("DELETE FROM [dbo].[DETALLE_FACTURA_PERS] WHERE [COD_CONTRATO_PROYECTO_TEMP] =", proyecto, "AND COD_FORMAS_PAGO_FECHAS=",fecha)
dbExecute(con, eliminar)
chunksize = 1000 # arbitrary chunk size
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==fecha & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==proyecto,]
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(', paste0(TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
}
factura(216,228)
proyecto=228
fecha=216
chunksize = 1000 # arbitrary chunk size
TABLA_TEMPORAL<-TOTAL_PERSONAS[TOTAL_PERSONAS$COD_FORMAS_PAGO_FECHAS==fecha & TOTAL_PERSONAS$COD_CONTRATO_PROYECTO==proyecto,]
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS], [COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(', paste0(TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
for (i in 1:ceiling(nrow(TABLA_TEMPORAL)/chunksize)) {
query = paste0("INSERT INTO [dbo].[DETALLE_FACTURA_PERS_TEMP] ([COD_DETALLE_FACTURA_PERS], [COD_CONTRATO_PROYECTO],[COD_ROL],[COD_FORMAS_PAGO_FECHAS],[VALOR_SIN_IMPUESTOS]) VALUES")
vals = NULL
for (j in 1:chunksize) {
k = (i-1)*chunksize+j
if (k <= nrow(TABLA_TEMPORAL)) {
vals[j] = paste0('(',k,",", paste0(TABLA_TEMPORAL$COD_CONTRATO_PROYECTO[k],",",TABLA_TEMPORAL$COD_ROL[k],",",TABLA_TEMPORAL$COD_FORMAS_PAGO_FECHAS[k],",",TABLA_TEMPORAL$VALOR_CON_PRESTACIONES[k],")"),collapse = ',')
}
}
query = paste0(query, paste0(vals,collapse=','))
dbExecute(con, query)
}
